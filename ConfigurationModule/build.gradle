apply plugin: "spring-boot"

jar {
    baseName = configurationModuleName
    version = jarVersion
}

dependencies {
    compile project(":CommonModule")
    compile "org.springframework.cloud:spring-cloud-config-server"
}

springBoot {
    mainClass = "dawid.kotarba.configuration.ConfigurationModule"
}

task createPropertiesFile(dependsOn: processResources) << {
    storeProperties("$buildDir", "application.properties", decorateCommonProperties(createCommonProperties()))
    storeProperties("$buildDir", "modules.properties", createModulesProperties())
    copyCommonProperties("$buildDir")
}

classes {
    dependsOn createPropertiesFile
}

def decorateCommonProperties(props) {
    props.setProperty("spring.profiles.active", "native")
    props.setProperty("spring.cloud.config.server.native.searchLocations", "classpath:config/")
    return props
}